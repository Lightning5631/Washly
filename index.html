<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="apple-touch-icon" href="Washly_Car_Wash_Logo_Design.png">
  <title>Washly</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f9ff;
      color: #333;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    header {
      background: #1e90ff;
      color: white;
      padding: 1rem;
      text-align: center;
      font-size: 1.4rem;
      font-weight: bold;
    }
    main {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
    }
    .screen { display: none; }
    .active { display: block; }
    .card {
      background: white;
      padding: 1.2rem;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      margin: 1rem auto;
      max-width: 450px;
      text-align: left;
    }
    button, input, select {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 12px;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    button {
      background: #1e90ff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #0a6acb;
    }
    nav {
      display: flex;
      justify-content: space-around;
      background: #fff;
      border-top: 1px solid #ddd;
      padding: 0.5rem 0;
    }
    nav button {
      background: none;
      border: none;
      color: #333;
      font-size: 0.9rem;
    }
    nav button.active-tab {
      color: #1e90ff;
      font-weight: bold;
    }
    ul { padding-left: 1.2rem; }
    .small-text { font-size: 0.9rem; color: gray; }
  </style>
</head>
<body>

  <header>Washly</header>

  <main>
    <!-- Home Screen -->
    <div class="screen active" id="home">
      <div class="card">
        <h2>Welcome to Washly üëã</h2>
        <p>On-demand eco-friendly car washing. Shine anywhere, anytime.</p>
      </div>
      <button onclick="showScreen('book')">üìÖ Schedule Pickup</button>
      <button onclick="showScreen('track')">üöó Track My Wash</button>
      <button onclick="showScreen('pricing')">üí≤ View Packages</button>
    </div>

    <!-- Booking Screen -->
    <div class="screen" id="book">
      <div class="card">
        <h2>Book a Wash</h2>
        <label>Date:</label>
        <input type="date" id="dateInput">
        <label>Time:</label>
        <input type="time" id="timeInput">
        <label>Service:</label>
        <select id="serviceInput">
          <option value="50">Quick Wash - $50</option>
          <option value="75">Full Exterior - $75</option>
          <option value="120">Exterior & Interior - $120</option>
          <option value="150">Premium Detail - $150</option>
        </select>
        <button onclick="bookService()">Confirm Booking</button>
      </div>
    </div>

    <!-- Track Screen -->
    <div class="screen" id="track">
      <div class="card">
        <h2>Your Bookings</h2>
        <div id="bookingList"><p>No active bookings.</p></div>
      </div>
    </div>

    <!-- Pricing Screen -->
    <div class="screen" id="pricing">
      <div class="card">
        <h2>Packages & Services</h2>
        <ul>
          <li><b>Quick Wash:</b> $50</li>
          <li><b>Full Exterior:</b> $75</li>
          <li><b>Exterior & Interior:</b> $120</li>
          <li><b>Premium Detail:</b> $150</li>
        </ul>
        <h3>Your Current Bill</h3>
        <p id="currentBill">$0</p>
        <p class="small-text">Only active (non-cancelled) bookings are included.</p>
      </div>
    </div>

    <!-- Settings Screen -->
    <div class="screen" id="settings">
      <div class="card">
        <h2>Settings ‚öôÔ∏è</h2>
        <p>Coming soon...</p>
      </div>
    </div>
  </main>

  <!-- Bottom Nav -->
  <nav>
    <button id="tab-home" class="active-tab" onclick="showScreen('home')">üè† Home</button>
    <button id="tab-book" onclick="showScreen('book')">üìÖ Book</button>
    <button id="tab-track" onclick="showScreen('track')">üöó Track</button>
    <button id="tab-pricing" onclick="showScreen('pricing')">üí≤ Pricing</button>
    <button id="tab-settings" onclick="showScreen('settings')">‚öôÔ∏è Settings</button>
  </nav>

  <script>
    let bookings = [];
    let bookingId = 0;

    function showScreen(screen) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screen).classList.add('active');
      document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-tab'));
      document.getElementById('tab-' + screen).classList.add('active-tab');
      if (screen === 'track') updateBookings();
      if (screen === 'pricing') updateBill();
    }

    function bookService() {
      const date = document.getElementById('dateInput').value;
      const time = document.getElementById('timeInput').value;
      const service = document.getElementById('serviceInput');
      const price = parseInt(service.value);
      const serviceName = service.options[service.selectedIndex].text;

      if (!date || !time) {
        alert("Please select both date and time.");
        return;
      }

      const pickupTime = new Date(`${date}T${time}`);
      const endTime = new Date(pickupTime.getTime() + 60 * 60 * 1000); // 1 hour wash

      bookings.push({
        id: bookingId++,
        service: serviceName,
        price,
        pickupTime,
        endTime,
        cancelled: false
      });

      alert("Booking confirmed!");
      showScreen('track');
    }

    function cancelBooking(id) {
      const booking = bookings.find(b => b.id === id);
      if (!booking) return;

      const now = new Date();
      if (now < booking.pickupTime) {
        booking.cancelled = true;
        alert("Booking cancelled.");
        updateBookings();
        updateBill();
      } else {
        alert("You can only cancel before the pickup time.");
      }
    }

    function updateBookings() {
      const container = document.getElementById('bookingList');
      container.innerHTML = "";

      const now = new Date();
      const activeBookings = bookings.filter(b => !b.cancelled);

      if (activeBookings.length === 0) {
        container.innerHTML = "<p>No active bookings.</p>";
        return;
      }

      activeBookings.forEach(b => {
        const div = document.createElement('div');
        div.classList.add('card');
        div.innerHTML = `<h3>${b.service}</h3>
          <p>Pickup: ${b.pickupTime.toLocaleString()}</p>
          <p>Price: $${b.price}</p>
          <p id="timer-${b.id}"></p>
          ${now < b.pickupTime ? `<button onclick="cancelBooking(${b.id})">Cancel Booking</button>` : ""}`;
        container.appendChild(div);
        updateTimer(b);
      });
    }

    function updateTimer(booking) {
      const timerEl = document.getElementById(`timer-${booking.id}`);
      if (!timerEl) return;

      const now = new Date();
      if (now < booking.pickupTime) {
        const diff = Math.floor((booking.pickupTime - now) / 1000);
        timerEl.textContent = `Pickup in: ${formatTime(diff)}`;
      } else if (now >= booking.pickupTime && now <= booking.endTime) {
        const diff = Math.floor((booking.endTime - now) / 1000);
        timerEl.textContent = `Wash in progress: ${formatTime(diff)} left`;
      } else {
        timerEl.textContent = "Completed ‚úÖ";
      }
    }

    function formatTime(seconds) {
      const h = Math.floor(seconds / 3600);
      const m = Math.floor((seconds % 3600) / 60);
      const s = seconds % 60;
      return `${h}h ${m}m ${s}s`;
    }

    setInterval(() => {
      bookings.forEach(updateTimer);
    }, 1000);

    function updateBill() {
      const total = bookings.filter(b => !b.cancelled).reduce((sum, b) => sum + b.price, 0);
      document.getElementById("currentBill").textContent = `$${total}`;
    }
  </script>

</body>
</html>

